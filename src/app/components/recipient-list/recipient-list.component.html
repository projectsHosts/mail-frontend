<div class="card shadow-sm">
  <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Email Recipients</h5>
    <div class="d-flex gap-2 align-items-center">
      <button class="btn btn-light btn-sm" (click)="loadRecipients()" [disabled]="loading">
        <i class="bi bi-arrow-clockwise"></i> Refresh
      </button>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" [(ngModel)]="autoRefresh" 
               id="autoRefresh">
        <label class="form-check-label text-white" for="autoRefresh">
          Auto-refresh
        </label>
      </div>
    </div>
  </div>

  <!-- Stats -->
  <div class="card-body border-bottom">
    <div class="row text-center">
      <div class="col">
        <div class="p-3 bg-warning bg-opacity-25 rounded">
          <div class="h4 mb-0 text-warning">{{ pendingCount }}</div>
          <small class="text-muted">Pending</small>
        </div>
      </div>
      <div class="col">
        <div class="p-3 bg-success bg-opacity-25 rounded">
          <div class="h4 mb-0 text-success">{{ sentCount }}</div>
          <small class="text-muted">Sent</small>
        </div>
      </div>
      <div class="col">
        <div class="p-3 bg-danger bg-opacity-25 rounded">
          <div class="h4 mb-0 text-danger">{{ failedCount }}</div>
          <small class="text-muted">Failed</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Recipients Table -->
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Status</th>
            <th>Sent At</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let recipient of recipients" 
              [class.table-warning]="recipient.status === 'PENDING'"
              [class.table-success]="recipient.status === 'SENT'"
              [class.table-danger]="recipient.status === 'FAILED'">
            <td>{{ recipient.name || 'N/A' }}</td>
            <td>{{ recipient.email }}</td>
            <td>
              <app-status-indicator 
                [status]="recipient.status"
                [message]="recipient.errorMessage">
              </app-status-indicator>
            </td>
            <td>
              {{ recipient.sentAt ? (recipient.sentAt | date:'medium') : 'Not sent' }}
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Empty State -->
      <div *ngIf="recipients.length === 0 && !loading" class="text-center py-5 text-muted">
        <p>No recipients found for this campaign</p>
      </div>

      <!-- Loading -->
      <div *ngIf="loading" class="text-center py-4">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    </div>
  </div>
</div>